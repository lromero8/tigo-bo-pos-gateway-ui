<!--
//
//  
//  
//
//  Created by Francisco Hernadez on 06-12-2018
//  Copyright Â© 2018 hightech-corp. All rights reserved.
//
-->

<div class="container-fluid container-fullw  box-shadow mb-5 pt-2">

    <form [formGroup]="cashierPayrollFrm" (validSubmit)="search()">
    
    <div class="row pb-4">
  
      <div class="col-md-2">
        <div class="form-group">			
          <label for="cashierNumber">N&uacute;mero de caja:</label>
          <input  type="text" name="cashierNumber" id="cashierNumber" class="form-control"  placeholder=" ..." formControlName="cashierNumber" autocomplete="off">
        </div>

        <div class="form-group">			
            <label for="EHumano">EHumano:</label>
            <input  type="text" name="EHumano" id="EHumano" class="form-control"  placeholder=" ..." formControlName="EHumano" autocomplete="off">
          </div>
      </div>
  
      <div class="col-md-2">
        <div class="form-group">			
          <label for="branchOffice">Sucural:</label>
          <input  type="text" name="branchOffice" id="branchOffice" class="form-control"  placeholder=" ..." formControlName="branchOffice" autocomplete="off">

        </div>

        <div class="form-group">			
            <label for="local">Local:</label>
            <input  type="text" name="local" id="local" class="form-control"  placeholder=" ..." formControlName="local" autocomplete="off">
  
          </div>
      </div>
  
      <div class="col-md-2">
        <div class="form-group">			
          <label for="date">Fecha:</label>
          <input  type="text" name="endDate" id="endDate" class="rdb form-control" bsDatepicker [bsConfig]="bsConfig" #dpb="bsDatepicker" readonly placeholder="Seleccione" formControlName="date">

        </div>

        <div class="form-group">			
            <label for="status">Estado:</label>
            <!--<input  type="text" name="status" id="status" class="form-control"  placeholder=" ..." formControlName="status" autocomplete="off"> -->
            <ng-select class="rdb" [items]="statuses" [selectOnTab]="true" bindValue="id" bindLabel="name" name="reason" id="reason" placeholder="Seleccione" formControlName="status"></ng-select>

          </div>
      </div>


      <div class="col-md-2">
          
  
          <div class="form-group">			
              <label for="period">Per&iacute;odo:</label>
              <input  type="text" name="period" id="period" class="form-control"  placeholder=" ..." formControlName="period" autocomplete="off">
            </div>
        </div>
  
      <div class="col-md-2">
      <div class="form-group">
          &nbsp;
        <label for=""> &nbsp; &nbsp; </label>
        <button class="btn btn-primary  btn-sm btn-block" type="submit" ngbTooltip="Buscar" type="submit">
            <i class="fa fa-search fa-lg"></i>
        </button>
      </div>   

      <div class="form-group">
        <label for=""> &nbsp; &nbsp; </label>
        <button class="btn btn-primary  btn-sm btn-block"  ngbTooltip="Cierre de caja" type="button" (click)="validSelected(auditRegister)" >
            <i class="fa fa-bank fa-lg"></i> 
        </button>
      </div>
          
      </div>
  
        <div class="col-md-2">
            

            <div class="form-group">
                &nbsp;
              <label for=""> &nbsp; &nbsp; </label>
              <button class="btn btn-primary  btn-sm btn-block"  ngbTooltip="Imprimir" (click)="print(printTpl)" type="button">
                  <i class="fa fa-print fa-lg"></i> 
              </button>
            </div>

            <div class="form-group">
              &nbsp;
            <label for=""> &nbsp; &nbsp; </label>
            <button class="btn btn-primary  btn-sm btn-block"  ngbTooltip="Limpiar" type="button">
                <i class="fa fa-eraser fa-lg"></i> 
            </button>
          </div>
  
        </div>
  
        </div>

      </form>
    </div>
  
  
    <h1 class="display-5 text-center mb-4">Reporte de planilla de caja</h1>

    <ngx-datatable
    class='material'
    [columnMode]="'force'"        
    [headerHeight]="70"
    [footerHeight]="50"
    [rowHeight]="'auto'"
    [limit]="5"
    [rows]='results'
    [selected]="selected"
    [selectionType]="'checkbox'"
    [selectAllRowsOnPage]="false"
    [displayCheck]="displayCheck"
    (activate)="onActivate($event)"
    (select)='onSelect($event)'>


      <ngx-datatable-column
                [width]="50"
                [sortable]="false"
                [canAutoResize]="false"
                [draggable]="false"
                [resizeable]="false"
                [headerCheckboxable]="false"
                [checkboxable]="true"
                (change)="hola()">      
    </ngx-datatable-column>          

      
      <ngx-datatable-column name="sucursal" prop="branchOffice"></ngx-datatable-column>
      <ngx-datatable-column name="Local" prop="local"></ngx-datatable-column>
      <ngx-datatable-column name="Caja" prop="register"></ngx-datatable-column>
      <ngx-datatable-column name="EHumano" prop="EHumano"></ngx-datatable-column>
      <ngx-datatable-column name="Periodo" prop="period"></ngx-datatable-column>
      <ngx-datatable-column name="Planilla" prop="payroll"></ngx-datatable-column>
      <ngx-datatable-column name="Estado de <br> planilla" prop="payrollStatus"></ngx-datatable-column>
      <ngx-datatable-column name="Fecha de <br> apertura" prop="startDate"></ngx-datatable-column>
      <ngx-datatable-column name="Hora de <br> apertura" prop="endDate"></ngx-datatable-column>
      <ngx-datatable-column name="Total cobrado <br> cierre" prop="totalCharging"></ngx-datatable-column>


      <!---ngx-datatable-column name="Acciones" prop="acciones" >
          <ng-template let-row="row" let-id="value" ngx-datatable-cell-template>
            <button class="btn btn-primary fa fa-pencil" (click)="openModal(modal)"></button>
          </ng-template>
      </ngx-datatable-column-->

    
  </ngx-datatable> 

<ng-template #auditRegister>
  <div class="modal-header modaleHeader">
    <h4 class="modal-title pull-left">cierre de caja</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide(); animateBank=false; cl()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    
    <h6 class="text-center text-bold font-weight-bold">Est&aacute; seguro de que quiere realizar un cierre de caja?</h6>
    <div class="row mt-4 justify-content-center align-items-center">

      <div class="col-md-12 mt-4">


          <ngx-datatable
          class='material'
          [columnMode]="'force'"        
          [headerHeight]="50"
          [footerHeight]="50"
          [rowHeight]="'auto'"
          [limit]="5"
          [rows]='selected'>
       
      
            
            <ngx-datatable-column name="sucursal" prop="branchOffice"></ngx-datatable-column>
            <ngx-datatable-column name="Local" prop="local"></ngx-datatable-column>
            <ngx-datatable-column name="Caja" prop="register"></ngx-datatable-column>
            <ngx-datatable-column name="EHumano" prop="EHumano"></ngx-datatable-column>
            <ngx-datatable-column name="Periodo" prop="period"></ngx-datatable-column>
            <ngx-datatable-column name="Planilla" prop="payroll"></ngx-datatable-column>
            <ngx-datatable-column name="Estado de planilla" prop="payrollStatus"></ngx-datatable-column>
            <ngx-datatable-column name="Fecha de apertura" prop="startDate"></ngx-datatable-column>
            <ngx-datatable-column name="Hora de apertura" prop="endDate"></ngx-datatable-column>
            <ngx-datatable-column name="Total cobrado cierre" prop="totalCharging"></ngx-datatable-column>
      
      
          </ngx-datatable>
        <div class="row justify-content-center align-items-center">


          <div class="ml-2 mr-2 ">
            <button class="btn btn-secondary" (click)="cancel()"> Cancelar</button>
          </div>
          <div class="ml-2 mr-2 ">
            <button class="btn btn-primary" (click)="auditCashRegister(payroll)" >Aceptar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #modal>
  <div class="modal-header modaleHeader">
    <h4 class="modal-title pull-left">modal</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide(); animateBank=false; ">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">


  </div>
</ng-template>


<ng-template #payroll>
  <div class="modal-header modaleHeader">
    <h4 class="modal-title pull-left">Planilla de caja</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide(); animateBank=false; ">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-2">
            <p class="font-weight-bold">Sucural: </p>
            <p class="font-weight-bold">Local: </p>
            <p class="font-weight-bold">Caja:</p>
            <p class="font-weight-bold">EHumano: </p>
          </div>
          <div class="col-md-4">
            <p>3 Santa Cruz</p>
            <p>1 EDIFICIO VIEDMA</p>
            <p>64 CAJA SINTESIS</p>
            <p>999 Telecel Bolivia</p>
          </div>
          <div class="col-md-2">

          </div>
          <div class="col-md-2">
            <p class="font-weight-bold">Planilla:</p>
            <p class="font-weight-bold">Fecha:</p>
          </div>
          <div class="col-md-2">
            <p>1</p>
            <p> 12-12-2018 </p>
          </div>
        </div>

        <!-- Other table-->
        <ngx-datatable
        class='material'
        [columnMode]="'force'"        
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5"
        [rows]='[]'>
     
    
        <ngx-datatable-column name="F. Pago" prop="paymentType"></ngx-datatable-column>
        <ngx-datatable-column name="Documento" prop="document"></ngx-datatable-column>
        <ngx-datatable-column name="Tot. Mo. Local" prop="totalLocalAmount"></ngx-datatable-column>
        <ngx-datatable-column name="Tot. Mo. Ext." prop="totalExtAmount"></ngx-datatable-column>
        <ngx-datatable-column name="Cotizacion" prop="quotation"></ngx-datatable-column>
        <ngx-datatable-column name="Numero" prop="number"></ngx-datatable-column>

        </ngx-datatable>

        <!--/ Other table-->
      </div>
    </div>

  </div>
</ng-template>


<ng-template #printTpl>
  <div class="modal-header modaleHeader">
    <h4 class="modal-title pull-left">Imprimir</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide(); animateBank=false; ">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <h6 class="text-center text-bold font-weight-bold">Â¿Esta seguro que desea realizar imprimir el item(s) seleccionado(s)?</h6>

    <div class="row justify-content-center align-items-center">


      <div class="ml-2 mr-2 ">
        <button class="btn btn-secondary" (click)="cancel()"> Cancelar</button>
      </div>
      <div class="ml-2 mr-2 ">
        <button class="btn btn-primary" (click)="printSelected()" >Aceptar</button>
      </div>
    </div>
  </div>
</ng-template>