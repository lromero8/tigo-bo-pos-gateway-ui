<!--
//
//  
//  
//
//  Created by -- on --
//  Copyright © 2018 hightech-corp. All rights reserved.
//
-->




<app-cancellations-money-search-bar (sendData)="search($event)" (clearData)="clear()" ></app-cancellations-money-search-bar>

<h1 class="display-5 text-center mb-4">Anular ingreso de dinero</h1>


<ngx-datatable
        class='material'
        [columnMode]="'force'"        
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5"
        [rows]='responseData?responseData:[]'>

  <ngx-datatable-column name="N° Factura" prop="billNumber" [width]="200"></ngx-datatable-column>
  <ngx-datatable-column name="N° Cliente" prop="clientId"[width]="200"></ngx-datatable-column>
  <ngx-datatable-column name="Deuda Cliente" prop="clientDebt"[width]="200"></ngx-datatable-column>
  <ngx-datatable-column name="Fecha" prop="paymentDate"[width]="200"></ngx-datatable-column>

  <ngx-datatable-column name="Acciones" prop="acciones" [width]="200">
      <ng-template let-row="row" let-id="value" ngx-datatable-cell-template>
        <button class="btn btn-primary" (click)="openModal(template, row); isDetail = true">Detalle</button>
        <button class="btn btn-danger ml-2" (click)="openModal(template, row); isDetail = false">Anular</button>
      </ng-template>      
  </ngx-datatable-column>


</ngx-datatable>




<!-- NGX-MODAL -->



<ng-template #template>
  <div class="modal-header modaleHeader">
    <h3 class="modal-title pull-left">{{isDetail?'Detalle de Egreso de Dinero':'Anular Egreso de Dinero'}}</h3>
    <button type="button" class="close pull-right" aria-label="Close" (click)="closeModal();cancelMoneyInputForm.reset()">
      <span aria-hidden="true" style="color: white">&times;</span>
    </button>
  </div>
  <div class="modal-body">

    <ng-container *ngIf="isDetail === false">

      <form class="" [formGroup]="cancelMoneyInputForm" (validSubmit)="anular()">


        <p class="font-weight-bold">Egreso de dinero: #{{billNumber}}</p>
        <br>
        <br>
        <h4 class="text-center">¿Esta seguro que desea anular el egreso #{{billNumber}}?</h4>
        <br>



        <br><br>

        <div class="row d-flex justify-content-center">
          

          <div class="col-md-6">
            <div class="form-group">
              <label for="">Motivo:</label>
              <ng-select class="rdb" [items]="reasons" [selectOnTab]="true" bindValue="id" bindLabel="name" name="reason" id="reason" placeholder="Seleccione" formControlName="reason"></ng-select>
            </div>
          </div>

        </div>



        <div class="row d-flex justify-content-center">


          <div class="col-md-6">
            <div class="form-group">
              <label for="">Comentario:</label>
              <textarea 
                class="rdb" 
                type="text" 
                name="comment" 
                formControlName="comment"
                rows="5" 
                cols="94"                  
                >
              </textarea> 
            </div>
          </div>

        </div>
       



          <div class="d-flex justify-content-center">
            <button class="btn btn-primary btn rdb" type="submit" ngbTooltip="Anular" [disabled]="cancelMoneyInputForm.invalid">
                Anular 
            </button>
          </div>

      </form>

    </ng-container>


    <ng-container *ngIf="isDetail === true">
      <h4 class="text-center">Detalle Egreso de dinero #{{billNumber}}?</h4>

      <br><br><br>
      <div class="card">
        <h5 class="card-header">Egreso</h5>
        <ul class="list-group list-group-flush">

          <div class="row ml-1 mt-2">
            <div class="col-md-4"><p class="font-weight-bold">Cliente:</p>{{details.clientName}}</div>
            <div class="col-md-4"><p class="font-weight-bold">Monto:</p>${{details.amountPayment}}</div>
            <div class="col-md-4"><p class="font-weight-bold">Fecha:</p>{{paymentDate}}</div>              
          </div>

        </ul>
      </div>

      <br>

      <div class="d-flex justify-content-end">
        <button class="btn btn-primary btn rdb" ngbTooltip="Cerrar" (click)="closeModal()">
          Cerrar 
        </button>
      </div>

    </ng-container>



  </div>
</ng-template>


<!-- NGX-MODAL -->